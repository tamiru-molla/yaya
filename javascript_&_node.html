<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Document</title>
</head>

<body>

 <xmp style="font-size: larger;">

=> Object property shorthand 
   const name="mike"
   const url="https://.."
   const ageOut=12;

   const x= {name:name, url:url,age:ageOut}
   # shorthand -> product ={name,url,age:ageOut}
    
  => obj destructuring
    const Objname = product.name  // how we acces each obj property
   # using obj destructuring 
       # const {name,url,age} = product
       # const objName = name;
       # const {name:newName,url,age,start=5} = product // start is default
       # const objName = newName; 
            -  posible to change property name during destructuring obj 
            -  assign default value also posible
       - if fuction has callback as argument 
        geocode ("etrhiopia",(err,{coordinate})=>{ 
           // assigning default value to destructured obj
              -> geocode ("etrhiopia",(err,{coordinate}={})=>{
          - wizout destructuring we have to call
            - response.coordinate
          - with destructuring
            - just coordinate

          
        })








  web server
  - modules needed - express
                    - hbs // handlbars
                    - path // core modules
   -our project have the ff structure
     .src/ 
       - app.js
     .public/  // static directory to serve 
       - style/styles.css 
       - script/scripts.css
     .templates/ 
        - views/  // response to request using end point
            # index.hbs
            # about.hbs  ..// templates for each html pages 
            # 404.hbs         - render by hbs engine
               
        - partials/   // page components appear in all pages
            # header.hbs 
            # footer.hbs
            # sidebars
   1) import all packages;
    
   2) define paths for express 
    
    # const publicDirPath = path.join(__dirname,"../public")
    # const partialDirPath = path.join(__dirname,"../templates/partials")
    # const viewsDirPath = path.join(__dirname,"../templates/views")

   4) setup static directry to serve
    
   # app.use(express.static(publicDirPath))

   4.1) for POST type form we need conmftgure body parser for express
             - query parser is default

   # app.use(express.urlencoded({ extended:false }))

   5) setup handlebar engine and views locations
    
    # app.set("views engine","hbs")
    # app.set("views",viewsDirPath)
    # hbs.registerPartials(partialDirPath);

   6)  response for requests
    
    # app.get("endPoints",(req,res)=>{   // endPoint='/', '/about'
     
     res.send(string | Json ...)
     res.render("target_template", { json passed to templates})
           target_template -> 'index.html', 'about.hbs',
           json -> {title:'Home' | title:'About', name: 'mike'}
    })
   
   7) response for error
        - endPoint = "*" -- any  unmatched endpoint
        - endPoint = "/help/*" -- any unmatched endpoint preceding with /help

   8) start server
       # apt.listen(3000,()=>{log("server- started")})


- calling partials in a pages
   <body>
     {{>header}}
   </body> 
   @ header partials
    we can access json object forward by res.render 
       -<h1>{{title}}</h1>
  


 
========================== uploading files  ====================
 
<form  method="POST" enctype ="multipart/form-data "></form>
<input type="file" name="imageFile" accept=".exetName,..." multiple>
        => accept - specify allowed file type               
     form enctype  types
                 - application/x-www-form-urlencoded
                       - default 
                       - all character encoded (space -> + or %20 ,special characters to ASCII)
                 - text/plain 
                       - no encoding
                 - multipart/form-data
                       - when we uoload file

=> required package - multer  
1) import and configure multer
    
 #  const multer = require('multer')
 #  const upload = multer({dest : pathToSaveFile})  // default path to uploaded file
 
 - upload obg used to upload single or multFile 
  app.post("/",upload.single("ValueOfnameAttribute"),(req,res){})
      - file property added to req Obj by multer

       req.file -- file
       req.body -- text content

      - file have 3 properties
           . path 
           . orginalName
           . size

 -> uploaded file is in binary format 
        - we need to rename it to its orginal file name 

      require("fs").renameSync(req.file.path, newPath/${req.file.orginalname})  (rename to move file)

-> uploading multiple files 

A) from one FiledName --- @ input:file - name:fieldName

  # upload.array(FiledName,maxCount)
     - req.files ->>>>> aray of files

B) from multiple fieldNames 

 # upload.fields([{name:'photo',maxCount:3},{name:'gallery',maxCount:9}])
    
     -req.files ---->>> object (key:FiledName, value= aray of files)


 =====  processing images
 app.post("/", upload.single("im"), async(req, res)=>{
   
   fs.renameSync(oldFileName,newFileName);
   const image = await jimp.read(newFileName);
   image.resize(320, jimp.AUTO);
   await image.write(`./public/images/thumbnails/${fileInfo.originalname}`)












  </xmp> 
  
</body>
</html>
